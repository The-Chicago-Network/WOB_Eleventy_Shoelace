{"version":3,"sources":["../src/insertion-checker.ts"],"sourcesContent":["const kInsertions = Symbol(\"lyra.insertions\");\n\n// Web platforms don't have process. React-Native doesn't have process.emitWarning.\nconst warn =\n  globalThis.process?.emitWarning ??\n  function emitWarning(message: string, options: { code: string }) {\n    console.warn(`[WARNING] [${options.code}] ${message}`);\n  };\n\nexport function trackInsertion(_lyra: unknown) {\n  const lyra = _lyra as object & { [kInsertions]?: number };\n\n  if (typeof lyra[kInsertions] !== \"number\") {\n    queueMicrotask(() => {\n      lyra[kInsertions] = undefined;\n    });\n\n    lyra[kInsertions] = 0;\n  }\n\n  if (lyra[kInsertions]! > 1000) {\n    warn(\n      \"Lyra's insert operation is synchronous. Please avoid inserting a large number of document in a single operation in order not to block the main thread.\",\n      { code: \"LYRA0001\" },\n    );\n\n    lyra[kInsertions] = -1;\n  } else if (lyra[kInsertions] >= 0) {\n    lyra[kInsertions]++;\n  }\n}\n"],"names":["globalThis","kInsertions","Symbol","warn","process","emitWarning","message","options","console","code","trackInsertion","_lyra","lyra","queueMicrotask","undefined"],"mappings":"IAIEA;AAJF,MAAMC,cAAcC,OAAO;AAE3B,mFAAmF;AACnF,MAAMC,OACJH,CAAAA,CAAAA,sBAAAA,WAAWI,OAAO,cAAlBJ,iCAAAA,KAAAA,IAAAA,oBAAoBK,WAAW,AAAD,KAC9B,SAASA,YAAYC,OAAe,EAAEC,OAAyB,EAAE;IAC/DC,QAAQL,IAAI,CAAC,CAAC,WAAW,EAAEI,QAAQE,IAAI,CAAC,EAAE,EAAEH,QAAQ,CAAC;AACvD;AAEF,OAAO,SAASI,eAAeC,KAAc,EAAE;IAC7C,MAAMC,OAAOD;IAEb,IAAI,OAAOC,IAAI,CAACX,YAAY,KAAK,UAAU;QACzCY,eAAe,IAAM;YACnBD,IAAI,CAACX,YAAY,GAAGa;QACtB;QAEAF,IAAI,CAACX,YAAY,GAAG;IACtB,CAAC;IAED,IAAIW,IAAI,CAACX,YAAY,GAAI,MAAM;QAC7BE,KACE,0JACA;YAAEM,MAAM;QAAW;QAGrBG,IAAI,CAACX,YAAY,GAAG,CAAC;IACvB,OAAO,IAAIW,IAAI,CAACX,YAAY,IAAI,GAAG;QACjCW,IAAI,CAACX,YAAY;IACnB,CAAC;AACH,CAAC"}